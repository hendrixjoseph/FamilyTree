<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/resource/template/mainTemplate.xhtml"    
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    
    <f:metadata>
        <f:viewParam name="personId" value="#{individualBean.personId}"/>
    </f:metadata>

    <ui:define name="title">
        #{individualBean.person.name} details
    </ui:define>

    <!--ui:define name="north">            

    </ui:define -->
    
    <ui:define name="south">
        <p:layoutUnit position="south">
            <h:form>
                <p:commandButton value="Edit person" type="button" onclick="PF('editDialog').show();" /> 
            </h:form>
        </p:layoutUnit>
    </ui:define>    
    
    <!-- ui:define name="east">East</ui:define -->
    
    <ui:define name="west">
        <ui:include src="/WEB-INF/resource/template/personPanelTemplate.xhtml" />
    </ui:define>
    
    <ui:define name="center">
        <p:layoutUnit position="center">
            <p:tabView>
                <c:forEach  items="#{individualBean.person.spouseChildMap.keySet()}" var="spouse">
                    <p:tab title="#{spouse.name}">
                        <c:forEach items="#{individualBean.person.spouseChildMap.get(spouse)}" var="child">
                            <p:link value="#{child.name}">
                                <f:param name="personId" value="#{child.id}" />
                            </p:link>                               
                        </c:forEach>
                        <p>
                            <h:form>
                                <p:commandButton value="Add child" type="button" onclick="PF('addChildDialog').show(); #{insertPersonBean.setSpouse(spouse)};"/>
                            </h:form>
                        </p>
                        <p>
                            <p:link value="View spouse's page">
                                <f:param name="personId" value="#{spouse.id}" />                                            
                            </p:link>
                        </p>
                    </p:tab>
                </c:forEach>
                <p:tab title="Add spouse or children">
                    <p>
                        <h:form>
                            <p:commandButton value="Add spouse" type="button" onclick="PF('addSpouseDialog').show();" />
                        </h:form>
                    </p><p>
                        <h:form>
                            <p:commandButton value="Add child" type="button" onclick="PF('addChildSingleParentDialog').show();" />
                        </h:form>
                    </p>
                </p:tab>
            </p:tabView>
        </p:layoutUnit>
    </ui:define>
</ui:composition>